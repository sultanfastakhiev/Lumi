import numpy as np
import pandas as pd
import re
import os
# ggg
# df = pd.read_csv('drive/My Drive/P.csv', sep=';', decimal=',', dtype={'PatientKey': 'Int32'}, encoding='utf-8',
#                  parse_dates=['BirthDate', 'LaboratoryResultsDate', 'MinLaboratoryResultsDate'])


def Gleb(df):
    def lab_result_proc(s):
        '''
        The best method for describing RegEx:
        r"""(?x)\d +  # the integral part
                \.    # the decimal point
                \d *  # some fractional digits"""
        '''
        pattern_1 = r'^\^?\s?[<>]?=?\s?(-?\d+[.,]?\d*).*$'
        pattern_2 = r'^(-?\d+[.,]?\d*)\s?-\s?(-?\d+[.,]?\d*)$'
        pattern_3 = r'.*\n?.*>=?\s?(-?\d+[.,]?\d*).*\n?.*'
        pattern_4 = r'.*\n?.*<=?\s?(-?\d+[.,]?\d*).*\n?.*'
        res_val = s['ValueText']
        res_num = re.fullmatch(pattern_1, res_val) if isinstance(res_val, str) else False
        res_val = float(res_num.group(1).replace(',', '.')) if res_num else np.nan
        ref_min = s['RefMin']
        ref_max = s['RefMax']
        ref_text = s['RefText']
        ref_range = re.fullmatch(pattern_2, ref_text) if isinstance(ref_text, str) else False
        ref_great = re.fullmatch(pattern_3, ref_text) if isinstance(ref_text, str) else False
        ref_less = re.fullmatch(pattern_4, ref_text) if isinstance(ref_text, str) else False
        ref_min = ref_min if np.isnan(ref_min) == False \
            else float(ref_range.group(1).replace(',', '.')) if ref_range \
            else float(ref_great.group(1).replace(',', '.')) if ref_great \
            else ref_min
        ref_max = ref_max if np.isnan(ref_max) == False \
            else float(ref_range.group(2).replace(',', '.')) if ref_range \
            else float(ref_less.group(1).replace(',', '.')) if ref_less \
            else ref_max
        return res_val, ref_min, ref_max

    def lab_result_value(s):
        result, _, _ = lab_result_proc(s)
        return result

    def lab_result_min(s):
        _, result, _ = lab_result_proc(s)
        return result

    def lab_result_max(s):
        _, _, result = lab_result_proc(s)
        return result

    def path_lab_result_proc(s):
        pattern_neg = r'(?is).*не обнар.*|.*отриц.*|.*отсут.*|.*не выявл.*|.*не найден.*|.*neg.*|.*norm.*|.*none.*|.*not found.*|^-*$'
        pattern_pos = r'(?is).*обнар.*|.*полож.*|.*присут.*|.*выявл.*|.*pos.*|^\+*$'
        res_val = s['Value']
        ref_min = s['RefMin']
        ref_max = s['RefMax']
        result = 0
        if pd.notnull(res_val):
            if isinstance(res_val, str):
                if re.fullmatch(pattern_neg, res_val):
                    result = 1
                elif re.fullmatch(pattern_pos, res_val):
                    result = 2
            elif pd.isnull(ref_min) and pd.notnull(ref_max):
                if (res_val <= ref_max):
                    result = 1
                else:
                    result = 2
            elif pd.notnull(ref_min) and pd.isnull(ref_max):
                if (ref_min <= res_val):
                    result = 1
                else:
                    result = 2
            elif pd.notnull(ref_min) and pd.notnull(ref_max) and isinstance(ref_min, float) and isinstance(ref_max,
                                                                                                           float):
                if (ref_min <= res_val <= ref_max):
                    result = 1
                else:
                    result = 2
        return result

    # 'Есть патология' if result == 2 else 'Нет патологии' if result == 1 else 'Не определенно'

    def age_group(elem):
        if elem['Age'] < 1:
            return 1
        elif 1 <= elem['Age'] <= 3:
            return 2
        elif 4 <= elem['Age'] <= 12:
            return 3
        elif 13 <= elem['Age'] < 18:
            return 4
        elif 18 <= elem['Age'] <= 29:
            return 5
        elif 30 <= elem['Age'] <= 45:
            return 6
        elif 46 <= elem['Age'] <= 59 and elem['Gender'] == 1:
            return 7
        elif 46 <= elem['Age'] <= 64 and elem['Gender'] == 0:
            return 8
        elif 60 <= elem['Age'] and elem['Gender'] == 1:
            return 9
        elif 65 <= elem['Age'] and elem['Gender'] == 0:
            return 10

    def path_lab_result_proc_2(s):
        pattern_neg = r'''(?is).*не обнар.*|.*отриц.*|.*отсут.*|.*не выявл.*|.*не найден.*|.*neg.*|.*norm.*|.*none.*|.*not found.*|
                                .*небольшое количество.*|.*незначительно.*|.*единичные в препарате.*|
                                .*полная.*|.*прозрачная.*|.*желтый.*|.*оттенки желтого.*|^-*$'''
        pattern_pos = r'(?is).*обнар.*|.*полож.*|.*присут.*|.*выявл.*|.*pos.*|^\+*$'
        res_val = s['ValueText']
        result = 0
        if pd.notnull(res_val):
            if isinstance(res_val, str):
                if re.fullmatch(pattern_neg, res_val):
                    result = 1
                elif re.fullmatch(pattern_pos, res_val):
                    result = 2
        return result



    filter3 = (df['Value'].isnull())
    df.loc[filter3, 'Value'] = df.loc[filter3].apply(lab_result_value, axis=1)
    filter4 = (df['RefMin'].isnull())
    df.loc[filter4, 'RefMin'] = df.loc[filter4].apply(lab_result_min, axis=1)
    filter5 = (df['RefMax'].isnull())
    df.loc[filter5, 'RefMax'] = df.loc[filter5].apply(lab_result_max, axis=1)
    df['Pathology'] = df.apply(path_lab_result_proc, axis=1)
    filter3 = (df['Value'].isnull())
    df.loc[filter3, 'Pathology'] = df.loc[filter3].apply(path_lab_result_proc_2, axis=1)
    filter3 = (df['Value'].isnull())
    df['Pathology'] = df['Pathology'] - 1
    df.loc[filter3, 'Value'] = df.loc[filter3, 'Pathology']
    df['Value'] = df.apply(lambda row: 0 if row['ValueText'] == row['RefText'] else row['Value'], axis=1)
    df = df[(df.Value <= 5000) | (df.Value.isnull())]
    data = df.pivot_table(index=['PatientKey']
                          , columns=['LaboratoryMethodsKey']
                          , values=['Value', 'Pathology']
                          , aggfunc='first'
                          , fill_value=-1
                          )

    data.reset_index(col_level=1).to_csv('lena.csv', encoding='utf-8', index=False)
    df_1 = pd.read_csv('lena.csv', sep=',', encoding='utf-8', header=1)
    a = ["PatientKey",
        "25235",
        "25237",
        "25238",
        "25239",
        "25240",
        "25242",
        "25244",
        "25245",
        "25246",
        "25247",
        "25255",
        "25256",
        "25257",
        "25258",
        "25259",
        "25532",
        "25533",
        "25535",
        "25536",
        "25538",
        "25539",
        "25540",
        "25541",
        "25542",
        "25543",
        "25544",
        "25545",
        "25546",
        "25547",
        "25548",
        "25549",
        "25550",
        "25551",
        "25552",
        "25554",
        "25555",
        "25556",
        "25557",
        "25558",
        "25559",
        "25560",
        "25561",
        "25562",
        "25563",
        "25564",
        "25565",
        "25566",
        "25567",
        "25568",
        "25569",
        "25570",
        "25571",
        "25572",
        "25573",
        "25574",
        "25575",
        "25576",
        "25577",
        "25578",
        "25579",
        "25580",
        "25581",
        "25582",
        "25583",
        "25584",
        "25585",
        "25586",
        "25587",
        "25588",
        "25589",
        "25590",
        "25591",
        "25592",
        "25593",
        "25594",
        "25595",
        "25596",
        "25597",
        "25598",
        "25599",
        "25600",
        "25601",
        "25602",
        "25604",
        "25605",
        "25606",
        "25607",
        "25608",
        "25609",
        "25610",
        "25611",
        "25612",
        "25613",
        "25614",
        "25615",
        "25616",
        "26923",
        "26926",
        "9991443",
        "9991444",
        "9991445",
        "9991446",
        "9991447",
        "9991448",
        "9991449",
        "9991537",
        "9991538",
        "9991539",
        "9991540",
        "9991541",
        "9995650",
        "9995655",
        "9995658",
        "9995659",
        "9995660",
        "9995788",
        "9997122",
        "9997123",
        "9997124",
        "9997125",
        "9997126",
        "9997127",
        "9997128",
        "9997129",
        "9997130",
        "9997131",
        "9997132",
        "9997133",
        "9997134",
        "9997135",
        "9997137",
        "9997138",
        "9997139",
        "9997140",
        "9997141",
        "9997143",
        "9998728",
        "9998729",
        "9998730",
        "9998731",
        "9998732",
        "9998733",
        "9998735",
        "9998736",
        "9998737",
        "9998738",
        "9998739",
        "9998740",
        "9998741",
        "9998742",
        "9998744",
        "9998745",
        "9998746",
        "9998747",
        "9998748",
        "9998749",
        "9998750",
        "9998751",
        "9998795",
        "9998838",
        "9998839",
        "9998840",
        "9998841",
        "9998842",
        "9998843",
        "9998844",
        "9998845",
        "9998846",
        "9998847",
        "9998848",
        "9998849",
        "9998850",
        "9998851",
        "9998854",
        "9998855",
        "9998856",
        "9998857",
        "9998858",
        "9998923",
        "9998924",
        "9998925",
        "9998926",
        "9998927",
        "9998928",
        "9998930",
        "9998931",
        "9998932",
        "9998933",
        "9998934",
        "9998935",
        "9998936",
        "9998937",
        "9998938",
        "9998940",
        "9998941",
        "9998942",
        "9998943",
        "9998944",
        "9998945",
        "9998946",
        "9998947",
        "9998949",
        "9998950",
        "9998951",
        "9998952",
        "9998953",
        "9998954",
        "9998955",
        "9998956",
        "9998957",
        "9998958",
        "9998959",
        "9998960",
        "9998961",
        "9998962",
        "9998963",
        "9998964",
        "9998965",
        "9998966",
        "9998967",
        "9998968",
        "9998969",
        "9998970",
        "9998971",
        "9999073",
        "9999133",
        "9999330",
        "9999338",
        "9999339",
        "9999340",
        "9999341",
        "9999342",
        "9999344",
        "9999348",
        "9999349",
        "9999350",
        "9999352",
        "9999374",
        "9999465",
        "9999466",
        "9999467",
        "9999468",
        "9999469",
        "9999470",
        "9999471",
        "9999472",
        "9999473",
        "9999474",
        "9999475",
        "9999476",
        "9999477",
        "9999478",
        "9999479",
        "9999480",
        "9999481",
        "9999485",
        "9999486",
        "9999487",
        "9999488",
        "9999489",
        "9999490",
        "9999491",
        "9999492",
        "9999493",
        "9999494",
        "9999497",
        "9999498",
        "9999499",
        "9999523",
        "9999648",
        "9999649",
        "9999650",
        "9999651",
        "9999652",
        "9999653",
        "9999654",
        "9999655",
        "9999656",
        "9999657",
        "9999658",
        "9999659",
        "9999660",
        "9999661",
        "9999662",
        "9999663",
        "9999664",
        "9999665",
        "9999738",
        "9999766",
        "9999767",
        "9999768",
        "9999873",
        "9999924",
        "10000199",
        "10000200",
        "10000429",
        "10000478",
        "10000498",
        "10000499",
        "10000515",
        "10001021",
        "10001230",
        "10001439",
        "10001440",
        "10001763",
        "10001764",
        "10001765",
        "10001766",
        "10001767",
        "10001768",
        "10001769",
        "10001770",
        "10001771",
        "10001772",
        "10002283",
        "10002284",
        "10002326",
        "10002395",
        "10002608",
        "10002610",
        "10002614",
        "10002667",
        "10002676",
        "10002677",
        "10002777",
        "10002840",
        "10002878",
        "10002885",
        "10002887",
        "10002891",
        "10002932",
        "10002992",
        "10003007",
        "10003030",
        "10003047",
        "10003048",
        "10003049",
        "10003050",
        "10003051",
        "10003052",
        "10003053",
        "10003054",
        "10003055",
        "10003056",
        "10003057",
        "10003058",
        "10003059",
        "10003060",
        "10003061",
        "10003062",
        "10003063",
        "10003064",
        "10003065",
        "10003066",
        "10003067",
        "10003143",
        "10003144",
        "10003145",
        "10003146",
        "10003147",
        "10003148",
        "10003149",
        "10003150",
        "10003151",
        "10003152",
        "10003153",
        "10003154",
        "10003155",
        "10003156",
        "10003157",
        "10003158",
        "10003159",
        "10003160",
        "10003161",
        "10003162",
        "10003163",
        "10003353",
        "10004764",
        "10005137",
        "10005140",
        "10005142",
        "10005143",
        "10005144",
        "10005145",
        "10005154",
        "10005157",
        "10005222",
        "10005230",
        "10005241",
        "10005295",
        "10005296",
        "10005298",
        "10005299",
        "10005300",
        "10005301",
        "10005302",
        "10005303",
        "10005304",
        "10005305",
        "10005306",
        "10005307",
        "10005308",
        "10005309",
        "10005310",
        "10005311",
        "10005312",
        "10005313",
        "10005314",
        "10005315",
        "10005350",
        "10005395",
        "10005396",
        "10005401",
        "10005424",
        "10005471",
        "10005472",
        "10005473",
        "10005474",
        "10005495",
        "10005503",
        "10005618",
        "10005622",
        "10005623",
        "10005624",
        "10005625",
        "10005629",
        "10005630",
        "10005754",
        "10005755",
        "10005756",
        "10005757",
        "10005758",
        "10005759",
        "10005761",
        "10005763",
        "10005764",
        "10005765",
        "10005766",
        "10005767",
        "10005769",
        "10005770",
        "10005771",
        "10005772",
        "10005774",
        "10005775",
        "10005776",
        "10005777",
        "10005795",
        "10005797",
        "10005798",
        "10005799",
        "10005801",
        "10005802",
        "10005804",
        "10005805",
        "10005806",
        "10005807",
        "10005808",
        "10005809",
        "10005810",
        "10005821",
        "10005823",
        "10005824",
        "10005825",
        "10005828",
        "10005829",
        "10005830",
        "10005831",
        "10005938",
        "10005940",
        "10005941",
        "10005942",
        "10005943",
        "10005944",
        "10005945",
        "10005946",
        "10005947",
        "10005948",
        "10005949",
        "10005950",
        "10005951",
        "10005952",
        "10005953",
        "10005954",
        "10005955",
        "10005956",
        "10005957",
        "10005958",
        "10005959",
        "10005960",
        "10005961",
        "10005962",
        "10005963",
        "10005964",
        "10005965",
        "10005966",
        "10005967",
        "10005968",
        "10005969",
        "10005970",
        "10005971",
        "10005972",
        "10005973",
        "10005974",
        "10005975",
        "10005976",
        "10005977",
        "10005978",
        "10005979",
        "10005980",
        "10005981",
        "10005982",
        "10005983",
        "10005984",
        "10005985",
        "10005986",
        "10005987",
        "10005988",
        "10005989",
        "10005990",
        "10005991",
        "10005992",
        "10005993",
        "10005994",
        "10005995",
        "10005996",
        "10005997",
        "10005998",
        "10005999",
        "10006000",
        "10006001",
        "10006002",
        "10006003",
        "10006004",
        "10006005",
        "10006006",
        "10006007",
        "10006008",
        "10006009",
        "10006045",
        "10006126",
        "10006259",
        "10006304",
        "10006305",
        "10006306",
        "10006310",
        "10006311",
        "10006360",
        "10006370",
        "10006436",
        "10006698",
        "10006809",
        "10006810",
        "10006813",
        "10006816",
        "10006824",
        "10006825",
        "10006826",
        "10006827",
        "10006828",
        "10006829",
        "10006830",
        "10006831",
        "10006832",
        "10006833",
        "10006834",
        "10006835",
        "10006836",
        "10006838",
        "10006839",
        "10006840",
        "10006841",
        "10006842",
        "10006843",
        "10006844",
        "10006845",
        "10006846",
        "10006847",
        "10006848",
        "10006849",
        "10006850",
        "10006851",
        "10006852",
        "10006853",
        "10006854",
        "10006855",
        "10006856",
        "10006857",
        "10006858",
        "10006859",
        "10006860",
        "10006861",
        "10006862",
        "10006863",
        "10006864",
        "10007382",
        "10007383",
        "10007384",
        "10007385",
        "10007386",
        "10007387",
        "10007388",
        "10007469",
        "10007490",
        "10007491",
        "10007493",
        "10007616",
        "10007618",
        "10007619",
        "10007623",
        "10007624",
        "10007625",
        "10007626",
        "10007634",
        "10007635",
        "10007705",
        "10007706",
        "10007707",
        "10007710",
        "10007711",
        "10007712",
        "10007713",
        "10007714",
        "10007715",
        "10007716",
        "10007717",
        "10007728",
        "10007733",
        "10007736",
        "10007749",
        "10007754",
        "10007755",
        "10007756",
        "10007762",
        "10007763",
        "10007765",
        "10007766",
        "10007779",
        "10007783",
        "10007784",
        "10007785",
        "10007786",
        "10007808",
        "10007809",
        "10007810",
        "10007811",
        "10007812",
        "10007813",
        "10007814",
        "10007815",
        "10007816",
        "10007817",
        "10007818",
        "10007819",
        "10007820",
        "10007821",
        "10007822",
        "10007823",
        "10007824",
        "10007825",
        "10007826",
        "10007827",
        "10007828",
        "10007829",
        "10007830",
        "10007831",
        "10007832",
        "10007833",
        "10007834",
        "10007835",
        "10007836",
        "10007837",
        "10007866",
        "10007882",
        "10007884",
        "10007998",
        "10007999",
        "10008000",
        "10008003",
        "10008004",
        "10008005",
        "10008006",
        "10008007",
        "10008008",
        "10008028",
        "10008032",
        "10008094",
        "10008163",
        "10008164",
        "10008187",
        "10008194",
        "10008195",
        "10008196",
        "10008243",
        "10008334",
        "10008335",
        "10008474",
        "10008561",
        "10008751",
        "10008752",
        "10008897",
        "10008986",
        "10009069",
        "10009070",
        "10009073",
        "10009074",
        "10009116",
        "10009231",
        "10009384",
        "10009393",
        "10009394",
        "10009395",
        "10009396",
        "10009397",
        "10009398",
        "10009399",
        "10009400",
        "10009401",
        "10009402",
        "10009403",
        "10009404",
        "10009405",
        "10009406",
        "10009407",
        "10009408",
        "10009412",
        "10009413",
        "10009414",
        "10009415",
        "10009416",
        "10009417",
        "10009421",
        "10009422",
        "10009423",
        "10009424",
        "10009426",
        "10009427",
        "10009428",
        "10009429",
        "10009431",
        "10009432",
        "10009433",
        "10009434",
        "10009435",
        "10009437",
        "10009438",
        "10009439",
        "10009442",
        "10009443",
        "10009444",
        "10009445",
        "10009446",
        "10009447",
        "10009448",
        "10009449",
        "10009450",
        "10009451",
        "10009452",
        "10009453",
        "10009454",
        "10009455",
        "10009456",
        "10009457",
        "10009458",
        "10009459",
        "10009460",
        "10009461",
        "10009462",
        "10009463",
        "10009464",
        "10009465",
        "10009467",
        "10009468",
        "10009469",
        "10009470",
        "10009471",
        "10009472",
        "10009483",
        "10009484",
        "10009485",
        "10009495",
        "10009499",
        "10009500",
        "10009501",
        "10009502",
        "10009503",
        "10009504",
        "10009511",
        "10009512",
        "10009556",
        "10009557",
        "10009558",
        "10009559",
        "10009593",
        "10009594",
        "10009620",
        "10009739",
        "10009740",
        "10009867",
        "10009868",
        "10009869",
        "10009870",
        "10009871",
        "10009872",
        "10009873",
        "10009874",
        "10009875",
        "10009876",
        "10009877",
        "10009878",
        "10009879",
        "10009880",
        "10009881",
        "10009882",
        "10010145",
        "10010268",
        "10010345",
        "10010387",
        "10010451",
        "10010452",
        "10010453",
        "10010454",
        "10010455",
        "10010456",
        "10010457",
        "10010458",
        "10010515",
        "10010563",
        "10010641",
        "10010642",
        "10010643",
        "10010644",
        "10010645",
        "10010646",
        "10010647",
        "10010648",
        "10010649",
        "10010650",
        "10010651",
        "10010652",
        "10010653",
        "10010655",
        "10010765",
        "10010766",
        "10010767",
        "10010787",
        "10010832",
        "10010833",
        "10010834",
        "10010835",
        "10010836",
        "10010837",
        "10010838",
        "10010839",
        "10010840",
        "10010841",
        "10010842",
        "10010843",
        "10010844",
        "10010849",
        "10010883",
        "10010884",
        "10010885",
        "10010886",
        "10010887",
        "10010888",
        "10010889",
        "10010890",
        "10010891",
        "10010904",
        "10010906",
        "10010911",
        "10010936",
        "10010941",
        "10011247",
        "10011285",
        "10011290",
        "10011312",
        "10011376",
        "10011377",
        "10011378",
        "10011379",
        "10011380",
        "10011381",
        "10011382",
        "10011383",
        "10011384",
        "10011385",
        "10011485",
        "10011487",
        "10011519",
        "10011520",
        "10011649",
        "10011650",
        "10011651",
        "10011652",
        "10011653",
        "10011654",
        "10011655",
        "10011656",
        "10012045",
        "10012054",
        "10012180",
        "10012202",
        "10012203",
        "10012204",
        "10012205",
        "10012206",
        "10012207",
        "10012208",
        "10012209",
        "10012210",
        "10012211",
        "10012212",
        "10012213",
        "10012214",
        "10012215",
        "10012216",
        "10012217",
        "10012218",
        "10012219",
        "10012220",
        "10012221",
        "10012222",
        "10012223",
        "10012224",
        "10012225",
        "10012226",
        "10012232",
        "10012233",
        "10012234",
        "10012235",
        "10012236",
        "10012237",
        "10012238",
        "10012239",
        "10012240",
        "10012241",
        "10012242",
        "10012243",
        "10012244",
        "10012245",
        "10012246",
        "10012247",
        "10012248",
        "10012249",
        "10012250",
        "10012251",
        "10012252",
        "10012253",
        "10012254",
        "10012255",
        "10012256",
        "10012258",
        "10012291",
        "10012294",
        "10012307",
        "10012308",
        "10012394",
        "10012395",
        "10012396",
        "10012397",
        "10012398",
        "10012399",
        "10012400",
        "10012401",
        "10012402",
        "10012970",
        "10012971",
        "10012972",
        "10012973",
        "10012974",
        "10012975",
        "10012976",
        "10012977",
        "10012978",
        "10012979",
        "10012980",
        "10012981",
        "10012982",
        "10012983",
        "10012984",
        "10012985",
        "10012986",
        "10012987",
        "10013102",
        "10013103",
        "10013104",
        "10013105",
        "10013106",
        "10013107",
        "10013108",
        "10013109",
        "10013110",
        "10013111",
        "10013114",
        "10013115",
        "10013116",
        "10013117",
        "10013118",
        "10013120",
        "10013122",
        "10013142",
        "10013152",
        "10013154",
        "10013157",
        "10013167",
        "10013177",
        "10013364",
        "10013366",
        "10013368",
        "10013369",
        "10013371",
        "10013438",
        "10014014",
        "10014056",
        "10014472",
        "10014646",
        "10014648",
        "10014649",
        "10014713",
        "10014714",
        "10014715",
        "10014716",
        "10014717",
        "10014718",
        "10014719",
        "10014720",
        "10014721",
        "10014722",
        "10014723",
        "10014724",
        "10014725",
        "10014726",
        "10014912",
        "10014913",
        "10014914",
        "10014915",
        "10014916",
        "10014917",
        "10014918",
        "10014919",
        "10014920",
        "10014921",
        "10014922",
        "10014923",
        "10014924",
        "10014925",
        "10014926",
        "10014927",
        "10014928",
        "10014929",
        "10014930",
        "10014931",
        "10014932",
        "10014933",
        "10014934",
        "10014935",
        "10014936",
        "10014937",
        "10014938",
        "10014943",
        "10014944",
        "10014945",
        "10014946",
        "10014947",
        "10014948",
        "10014949",
        "10014950",
        "10014951",
        "10014952",
        "10014953",
        "10014954",
        "10014955",
        "10014956",
        "10014999",
        "10015017",
        "10015018",
        "10015019",
        "10015020",
        "10015021",
        "10015022",
        "10015023",
        "10015024",
        "10015025",
        "10015026",
        "10015027",
        "10015028",
        "10015029",
        "10015030",
        "10015031",
        "10015032",
        "10015033",
        "10015069",
        "10015070",
        "10015136",
        "10015137",
        "10015143",
        "10015144",
        "10015145",
        "10015146",
        "10015147",
        "10015148",
        "10015149",
        "10015150",
        "10015151",
        "10015258",
        "10015259",
        "25235.1",
        "25237.1",
        "25238.1",
        "25239.1",
        "25240.1",
        "25242.1",
        "25244.1",
        "25245.1",
        "25246.1",
        "25247.1",
        "25255.1",
        "25256.1",
        "25257.1",
        "25258.1",
        "25259.1",
        "25532.1",
        "25533.1",
        "25535.1",
        "25536.1",
        "25538.1",
        "25539.1",
        "25540.1",
        "25541.1",
        "25542.1",
        "25543.1",
        "25544.1",
        "25545.1",
        "25546.1",
        "25547.1",
        "25548.1",
        "25549.1",
        "25550.1",
        "25551.1",
        "25552.1",
        "25554.1",
        "25555.1",
        "25556.1",
        "25557.1",
        "25558.1",
        "25559.1",
        "25560.1",
        "25561.1",
        "25562.1",
        "25563.1",
        "25564.1",
        "25565.1",
        "25566.1",
        "25567.1",
        "25568.1",
        "25569.1",
        "25570.1",
        "25571.1",
        "25572.1",
        "25573.1",
        "25574.1",
        "25575.1",
        "25576.1",
        "25577.1",
        "25578.1",
        "25579.1",
        "25580.1",
        "25581.1",
        "25582.1",
        "25583.1",
        "25584.1",
        "25585.1",
        "25586.1",
        "25587.1",
        "25588.1",
        "25589.1",
        "25590.1",
        "25591.1",
        "25592.1",
        "25593.1",
        "25594.1",
        "25595.1",
        "25596.1",
        "25597.1",
        "25598.1",
        "25599.1",
        "25600.1",
        "25601.1",
        "25602.1",
        "25604.1",
        "25605.1",
        "25606.1",
        "25607.1",
        "25608.1",
        "25609.1",
        "25610.1",
        "25611.1",
        "25612.1",
        "25613.1",
        "25614.1",
        "25615.1",
        "25616.1",
        "26923.1",
        "26926.1",
        "9991443.1",
        "9991444.1",
        "9991445.1",
        "9991446.1",
        "9991447.1",
        "9991448.1",
        "9991449.1",
        "9991537.1",
        "9991538.1",
        "9991539.1",
        "9991540.1",
        "9991541.1",
        "9995650.1",
        "9995655.1",
        "9995658.1",
        "9995659.1",
        "9995660.1",
        "9995788.1",
        "9997122.1",
        "9997123.1",
        "9997124.1",
        "9997125.1",
        "9997126.1",
        "9997127.1",
        "9997128.1",
        "9997129.1",
        "9997130.1",
        "9997131.1",
        "9997132.1",
        "9997133.1",
        "9997134.1",
        "9997135.1",
        "9997137.1",
        "9997138.1",
        "9997139.1",
        "9997140.1",
        "9997141.1",
        "9997143.1",
        "9998728.1",
        "9998729.1",
        "9998730.1",
        "9998731.1",
        "9998732.1",
        "9998733.1",
        "9998735.1",
        "9998736.1",
        "9998737.1",
        "9998738.1",
        "9998739.1",
        "9998740.1",
        "9998741.1",
        "9998742.1",
        "9998744.1",
        "9998745.1",
        "9998746.1",
        "9998747.1",
        "9998748.1",
        "9998749.1",
        "9998750.1",
        "9998751.1",
        "9998795.1",
        "9998838.1",
        "9998839.1",
        "9998840.1",
        "9998841.1",
        "9998842.1",
        "9998843.1",
        "9998844.1",
        "9998845.1",
        "9998846.1",
        "9998847.1",
        "9998848.1",
        "9998849.1",
        "9998850.1",
        "9998851.1",
        "9998854.1",
        "9998855.1",
        "9998856.1",
        "9998857.1",
        "9998858.1",
        "9998923.1",
        "9998924.1",
        "9998925.1",
        "9998926.1",
        "9998927.1",
        "9998928.1",
        "9998930.1",
        "9998931.1",
        "9998932.1",
        "9998933.1",
        "9998934.1",
        "9998935.1",
        "9998936.1",
        "9998937.1",
        "9998938.1",
        "9998940.1",
        "9998941.1",
        "9998942.1",
        "9998943.1",
        "9998944.1",
        "9998945.1",
        "9998946.1",
        "9998947.1",
        "9998949.1",
        "9998950.1",
        "9998951.1",
        "9998952.1",
        "9998953.1",
        "9998954.1",
        "9998955.1",
        "9998956.1",
        "9998957.1",
        "9998958.1",
        "9998959.1",
        "9998960.1",
        "9998961.1",
        "9998962.1",
        "9998963.1",
        "9998964.1",
        "9998965.1",
        "9998966.1",
        "9998967.1",
        "9998968.1",
        "9998969.1",
        "9998970.1",
        "9998971.1",
        "9999073.1",
        "9999133.1",
        "9999330.1",
        "9999338.1",
        "9999339.1",
        "9999340.1",
        "9999341.1",
        "9999342.1",
        "9999344.1",
        "9999348.1",
        "9999349.1",
        "9999350.1",
        "9999352.1",
        "9999374.1",
        "9999465.1",
        "9999466.1",
        "9999467.1",
        "9999468.1",
        "9999469.1",
        "9999470.1",
        "9999471.1",
        "9999472.1",
        "9999473.1",
        "9999474.1",
        "9999475.1",
        "9999476.1",
        "9999477.1",
        "9999478.1",
        "9999479.1",
        "9999480.1",
        "9999481.1",
        "9999485.1",
        "9999486.1",
        "9999487.1",
        "9999488.1",
        "9999489.1",
        "9999490.1",
        "9999491.1",
        "9999492.1",
        "9999493.1",
        "9999494.1",
        "9999497.1",
        "9999498.1",
        "9999499.1",
        "9999523.1",
        "9999648.1",
        "9999649.1",
        "9999650.1",
        "9999651.1",
        "9999652.1",
        "9999653.1",
        "9999654.1",
        "9999655.1",
        "9999656.1",
        "9999657.1",
        "9999658.1",
        "9999659.1",
        "9999660.1",
        "9999661.1",
        "9999662.1",
        "9999663.1",
        "9999664.1",
        "9999665.1",
        "9999738.1",
        "9999766.1",
        "9999767.1",
        "9999768.1",
        "9999873.1",
        "9999924.1",
        "10000199.1",
        "10000200.1",
        "10000429.1",
        "10000478.1",
        "10000498.1",
        "10000499.1",
        "10000515.1",
        "10001021.1",
        "10001230.1",
        "10001439.1",
        "10001440.1",
        "10001763.1",
        "10001764.1",
        "10001765.1",
        "10001766.1",
        "10001767.1",
        "10001768.1",
        "10001769.1",
        "10001770.1",
        "10001771.1",
        "10001772.1",
        "10002283.1",
        "10002284.1",
        "10002326.1",
        "10002395.1",
        "10002608.1",
        "10002610.1",
        "10002614.1",
        "10002667.1",
        "10002676.1",
        "10002677.1",
        "10002777.1",
        "10002840.1",
        "10002878.1",
        "10002885.1",
        "10002887.1",
        "10002891.1",
        "10002932.1",
        "10002992.1",
        "10003007.1",
        "10003030.1",
        "10003047.1",
        "10003048.1",
        "10003049.1",
        "10003050.1",
        "10003051.1",
        "10003052.1",
        "10003053.1",
        "10003054.1",
        "10003055.1",
        "10003056.1",
        "10003057.1",
        "10003058.1",
        "10003059.1",
        "10003060.1",
        "10003061.1",
        "10003062.1",
        "10003063.1",
        "10003064.1",
        "10003065.1",
        "10003066.1",
        "10003067.1",
        "10003143.1",
        "10003144.1",
        "10003145.1",
        "10003146.1",
        "10003147.1",
        "10003148.1",
        "10003149.1",
        "10003150.1",
        "10003151.1",
        "10003152.1",
        "10003153.1",
        "10003154.1",
        "10003155.1",
        "10003156.1",
        "10003157.1",
        "10003158.1",
        "10003159.1",
        "10003160.1",
        "10003161.1",
        "10003162.1",
        "10003163.1",
        "10003353.1",
        "10004764.1",
        "10005137.1",
        "10005140.1",
        "10005142.1",
        "10005143.1",
        "10005144.1",
        "10005145.1",
        "10005154.1",
        "10005157.1",
        "10005222.1",
        "10005230.1",
        "10005241.1",
        "10005295.1",
        "10005296.1",
        "10005298.1",
        "10005299.1",
        "10005300.1",
        "10005301.1",
        "10005302.1",
        "10005303.1",
        "10005304.1",
        "10005305.1",
        "10005306.1",
        "10005307.1",
        "10005308.1",
        "10005309.1",
        "10005310.1",
        "10005311.1",
        "10005312.1",
        "10005313.1",
        "10005314.1",
        "10005315.1",
        "10005350.1",
        "10005395.1",
        "10005396.1",
        "10005401.1",
        "10005424.1",
        "10005471.1",
        "10005472.1",
        "10005473.1",
        "10005474.1",
        "10005495.1",
        "10005503.1",
        "10005618.1",
        "10005622.1",
        "10005623.1",
        "10005624.1",
        "10005625.1",
        "10005629.1",
        "10005630.1",
        "10005754.1",
        "10005755.1",
        "10005756.1",
        "10005757.1",
        "10005758.1",
        "10005759.1",
        "10005761.1",
        "10005763.1",
        "10005764.1",
        "10005765.1",
        "10005766.1",
        "10005767.1",
        "10005769.1",
        "10005770.1",
        "10005771.1",
        "10005772.1",
        "10005774.1",
        "10005775.1",
        "10005776.1",
        "10005777.1",
        "10005795.1",
        "10005797.1",
        "10005798.1",
        "10005799.1",
        "10005801.1",
        "10005802.1",
        "10005804.1",
        "10005805.1",
        "10005806.1",
        "10005807.1",
        "10005808.1",
        "10005809.1",
        "10005810.1",
        "10005821.1",
        "10005823.1",
        "10005824.1",
        "10005825.1",
        "10005828.1",
        "10005829.1",
        "10005830.1",
        "10005831.1",
        "10005938.1",
        "10005940.1",
        "10005941.1",
        "10005942.1",
        "10005943.1",
        "10005944.1",
        "10005945.1",
        "10005946.1",
        "10005947.1",
        "10005948.1",
        "10005949.1",
        "10005950.1",
        "10005951.1",
        "10005952.1",
        "10005953.1",
        "10005954.1",
        "10005955.1",
        "10005956.1",
        "10005957.1",
        "10005958.1",
        "10005959.1",
        "10005960.1",
        "10005961.1",
        "10005962.1",
        "10005963.1",
        "10005964.1",
        "10005965.1",
        "10005966.1",
        "10005967.1",
        "10005968.1",
        "10005969.1",
        "10005970.1",
        "10005971.1",
        "10005972.1",
        "10005973.1",
        "10005974.1",
        "10005975.1",
        "10005976.1",
        "10005977.1",
        "10005978.1",
        "10005979.1",
        "10005980.1",
        "10005981.1",
        "10005982.1",
        "10005983.1",
        "10005984.1",
        "10005985.1",
        "10005986.1",
        "10005987.1",
        "10005988.1",
        "10005989.1",
        "10005990.1",
        "10005991.1",
        "10005992.1",
        "10005993.1",
        "10005994.1",
        "10005995.1",
        "10005996.1",
        "10005997.1",
        "10005998.1",
        "10005999.1",
        "10006000.1",
        "10006001.1",
        "10006002.1",
        "10006003.1",
        "10006004.1",
        "10006005.1",
        "10006006.1",
        "10006007.1",
        "10006008.1",
        "10006009.1",
        "10006045.1",
        "10006126.1",
        "10006259.1",
        "10006304.1",
        "10006305.1",
        "10006306.1",
        "10006310.1",
        "10006311.1",
        "10006360.1",
        "10006370.1",
        "10006436.1",
        "10006698.1",
        "10006809.1",
        "10006810.1",
        "10006813.1",
        "10006816.1",
        "10006824.1",
        "10006825.1",
        "10006826.1",
        "10006827.1",
        "10006828.1",
        "10006829.1",
        "10006830.1",
        "10006831.1",
        "10006832.1",
        "10006833.1",
        "10006834.1",
        "10006835.1",
        "10006836.1",
        "10006838.1",
        "10006839.1",
        "10006840.1",
        "10006841.1",
        "10006842.1",
        "10006843.1",
        "10006844.1",
        "10006845.1",
        "10006846.1",
        "10006847.1",
        "10006848.1",
        "10006849.1",
        "10006850.1",
        "10006851.1",
        "10006852.1",
        "10006853.1",
        "10006854.1",
        "10006855.1",
        "10006856.1",
        "10006857.1",
        "10006858.1",
        "10006859.1",
        "10006860.1",
        "10006861.1",
        "10006862.1",
        "10006863.1",
        "10006864.1",
        "10007382.1",
        "10007383.1",
        "10007384.1",
        "10007385.1",
        "10007386.1",
        "10007387.1",
        "10007388.1",
        "10007469.1",
        "10007490.1",
        "10007491.1",
        "10007493.1",
        "10007616.1",
        "10007618.1",
        "10007619.1",
        "10007623.1",
        "10007624.1",
        "10007625.1",
        "10007626.1",
        "10007634.1",
        "10007635.1",
        "10007705.1",
        "10007706.1",
        "10007707.1",
        "10007710.1",
        "10007711.1",
        "10007712.1",
        "10007713.1",
        "10007714.1",
        "10007715.1",
        "10007716.1",
        "10007717.1",
        "10007728.1",
        "10007733.1",
        "10007736.1",
        "10007749.1",
        "10007754.1",
        "10007755.1",
        "10007756.1",
        "10007762.1",
        "10007763.1",
        "10007765.1",
        "10007766.1",
        "10007779.1",
        "10007783.1",
        "10007784.1",
        "10007785.1",
        "10007786.1",
        "10007808.1",
        "10007809.1",
        "10007810.1",
        "10007811.1",
        "10007812.1",
        "10007813.1",
        "10007814.1",
        "10007815.1",
        "10007816.1",
        "10007817.1",
        "10007818.1",
        "10007819.1",
        "10007820.1",
        "10007821.1",
        "10007822.1",
        "10007823.1",
        "10007824.1",
        "10007825.1",
        "10007826.1",
        "10007827.1",
        "10007828.1",
        "10007829.1",
        "10007830.1",
        "10007831.1",
        "10007832.1",
        "10007833.1",
        "10007834.1",
        "10007835.1",
        "10007836.1",
        "10007837.1",
        "10007866.1",
        "10007882.1",
        "10007884.1",
        "10007998.1",
        "10007999.1",
        "10008000.1",
        "10008003.1",
        "10008004.1",
        "10008005.1",
        "10008006.1",
        "10008007.1",
        "10008008.1",
        "10008028.1",
        "10008032.1",
        "10008094.1",
        "10008163.1",
        "10008164.1",
        "10008187.1",
        "10008194.1",
        "10008195.1",
        "10008196.1",
        "10008243.1",
        "10008334.1",
        "10008335.1",
        "10008474.1",
        "10008561.1",
        "10008751.1",
        "10008752.1",
        "10008897.1",
        "10008986.1",
        "10009069.1",
        "10009070.1",
        "10009073.1",
        "10009074.1",
        "10009116.1",
        "10009231.1",
        "10009384.1",
        "10009393.1",
        "10009394.1",
        "10009395.1",
        "10009396.1",
        "10009397.1",
        "10009398.1",
        "10009399.1",
        "10009400.1",
        "10009401.1",
        "10009402.1",
        "10009403.1",
        "10009404.1",
        "10009405.1",
        "10009406.1",
        "10009407.1",
        "10009408.1",
        "10009412.1",
        "10009413.1",
        "10009414.1",
        "10009415.1",
        "10009416.1",
        "10009417.1",
        "10009421.1",
        "10009422.1",
        "10009423.1",
        "10009424.1",
        "10009426.1",
        "10009427.1",
        "10009428.1",
        "10009429.1",
        "10009431.1",
        "10009432.1",
        "10009433.1",
        "10009434.1",
        "10009435.1",
        "10009437.1",
        "10009438.1",
        "10009439.1",
        "10009442.1",
        "10009443.1",
        "10009444.1",
        "10009445.1",
        "10009446.1",
        "10009447.1",
        "10009448.1",
        "10009449.1",
        "10009450.1",
        "10009451.1",
        "10009452.1",
        "10009453.1",
        "10009454.1",
        "10009455.1",
        "10009456.1",
        "10009457.1",
        "10009458.1",
        "10009459.1",
        "10009460.1",
        "10009461.1",
        "10009462.1",
        "10009463.1",
        "10009464.1",
        "10009465.1",
        "10009467.1",
        "10009468.1",
        "10009469.1",
        "10009470.1",
        "10009471.1",
        "10009472.1",
        "10009483.1",
        "10009484.1",
        "10009485.1",
        "10009495.1",
        "10009499.1",
        "10009500.1",
        "10009501.1",
        "10009502.1",
        "10009503.1",
        "10009504.1",
        "10009511.1",
        "10009512.1",
        "10009556.1",
        "10009557.1",
        "10009558.1",
        "10009559.1",
        "10009593.1",
        "10009594.1",
        "10009620.1",
        "10009739.1",
        "10009740.1",
        "10009867.1",
        "10009868.1",
        "10009869.1",
        "10009870.1",
        "10009871.1",
        "10009872.1",
        "10009873.1",
        "10009874.1",
        "10009875.1",
        "10009876.1",
        "10009877.1",
        "10009878.1",
        "10009879.1",
        "10009880.1",
        "10009881.1",
        "10009882.1",
        "10010145.1",
        "10010268.1",
        "10010345.1",
        "10010387.1",
        "10010451.1",
        "10010452.1",
        "10010453.1",
        "10010454.1",
        "10010455.1",
        "10010456.1",
        "10010457.1",
        "10010458.1",
        "10010515.1",
        "10010563.1",
        "10010641.1",
        "10010642.1",
        "10010643.1",
        "10010644.1",
        "10010645.1",
        "10010646.1",
        "10010647.1",
        "10010648.1",
        "10010649.1",
        "10010650.1",
        "10010651.1",
        "10010652.1",
        "10010653.1",
        "10010655.1",
        "10010765.1",
        "10010766.1",
        "10010767.1",
        "10010787.1",
        "10010832.1",
        "10010833.1",
        "10010834.1",
        "10010835.1",
        "10010836.1",
        "10010837.1",
        "10010838.1",
        "10010839.1",
        "10010840.1",
        "10010841.1",
        "10010842.1",
        "10010843.1",
        "10010844.1",
        "10010849.1",
        "10010883.1",
        "10010884.1",
        "10010885.1",
        "10010886.1",
        "10010887.1",
        "10010888.1",
        "10010889.1",
        "10010890.1",
        "10010891.1",
        "10010904.1",
        "10010906.1",
        "10010911.1",
        "10010936.1",
        "10010941.1",
        "10011247.1",
        "10011285.1",
        "10011290.1",
        "10011312.1",
        "10011376.1",
        "10011377.1",
        "10011378.1",
        "10011379.1",
        "10011380.1",
        "10011381.1",
        "10011382.1",
        "10011383.1",
        "10011384.1",
        "10011385.1",
        "10011485.1",
        "10011487.1",
        "10011519.1",
        "10011520.1",
        "10011649.1",
        "10011650.1",
        "10011651.1",
        "10011652.1",
        "10011653.1",
        "10011654.1",
        "10011655.1",
        "10011656.1",
        "10012045.1",
        "10012054.1",
        "10012180.1",
        "10012202.1",
        "10012203.1",
        "10012204.1",
        "10012205.1",
        "10012206.1",
        "10012207.1",
        "10012208.1",
        "10012209.1",
        "10012210.1",
        "10012211.1",
        "10012212.1",
        "10012213.1",
        "10012214.1",
        "10012215.1",
        "10012216.1",
        "10012217.1",
        "10012218.1",
        "10012219.1",
        "10012220.1",
        "10012221.1",
        "10012222.1",
        "10012223.1",
        "10012224.1",
        "10012225.1",
        "10012226.1",
        "10012232.1",
        "10012233.1",
        "10012234.1",
        "10012235.1",
        "10012236.1",
        "10012237.1",
        "10012238.1",
        "10012239.1",
        "10012240.1",
        "10012241.1",
        "10012242.1",
        "10012243.1",
        "10012244.1",
        "10012245.1",
        "10012246.1",
        "10012247.1",
        "10012248.1",
        "10012249.1",
        "10012250.1",
        "10012251.1",
        "10012252.1",
        "10012253.1",
        "10012254.1",
        "10012255.1",
        "10012256.1",
        "10012258.1",
        "10012291.1",
        "10012294.1",
        "10012307.1",
        "10012308.1",
        "10012394.1",
        "10012395.1",
        "10012396.1",
        "10012397.1",
        "10012398.1",
        "10012399.1",
        "10012400.1",
        "10012401.1",
        "10012402.1",
        "10012970.1",
        "10012971.1",
        "10012972.1",
        "10012973.1",
        "10012974.1",
        "10012975.1",
        "10012976.1",
        "10012977.1",
        "10012978.1",
        "10012979.1",
        "10012980.1",
        "10012981.1",
        "10012982.1",
        "10012983.1",
        "10012984.1",
        "10012985.1",
        "10012986.1",
        "10012987.1",
        "10013102.1",
        "10013103.1",
        "10013104.1",
        "10013105.1",
        "10013106.1",
        "10013107.1",
        "10013108.1",
        "10013109.1",
        "10013110.1",
        "10013111.1",
        "10013114.1",
        "10013115.1",
        "10013116.1",
        "10013117.1",
        "10013118.1",
        "10013120.1",
        "10013122.1",
        "10013142.1",
        "10013152.1",
        "10013154.1",
        "10013157.1",
        "10013167.1",
        "10013177.1",
        "10013364.1",
        "10013366.1",
        "10013368.1",
        "10013369.1",
        "10013371.1",
        "10013438.1",
        "10014014.1",
        "10014056.1",
        "10014472.1",
        "10014646.1",
        "10014648.1",
        "10014649.1",
        "10014713.1",
        "10014714.1",
        "10014715.1",
        "10014716.1",
        "10014717.1",
        "10014718.1",
        "10014719.1",
        "10014720.1",
        "10014721.1",
        "10014722.1",
        "10014723.1",
        "10014724.1",
        "10014725.1",
        "10014726.1",
        "10014912.1",
        "10014913.1",
        "10014914.1",
        "10014915.1",
        "10014916.1",
        "10014917.1",
        "10014918.1",
        "10014919.1",
        "10014920.1",
        "10014921.1",
        "10014922.1",
        "10014923.1",
        "10014924.1",
        "10014925.1",
        "10014926.1",
        "10014927.1",
        "10014928.1",
        "10014929.1",
        "10014930.1",
        "10014931.1",
        "10014932.1",
        "10014933.1",
        "10014934.1",
        "10014935.1",
        "10014936.1",
        "10014937.1",
        "10014938.1",
        "10014943.1",
        "10014944.1",
        "10014945.1",
        "10014946.1",
        "10014947.1",
        "10014948.1",
        "10014949.1",
        "10014950.1",
        "10014951.1",
        "10014952.1",
        "10014953.1",
        "10014954.1",
        "10014955.1",
        "10014956.1",
        "10014999.1",
        "10015017.1",
        "10015018.1",
        "10015019.1",
        "10015020.1",
        "10015021.1",
        "10015022.1",
        "10015023.1",
        "10015024.1",
        "10015025.1",
        "10015026.1",
        "10015027.1",
        "10015028.1",
        "10015029.1",
        "10015030.1",
        "10015031.1",
        "10015032.1",
        "10015033.1",
        "10015069.1",
        "10015070.1",
        "10015136.1",
        "10015137.1",
        "10015143.1",
        "10015144.1",
        "10015145.1",
        "10015146.1",
        "10015147.1",
        "10015148.1",
        "10015149.1",
        "10015150.1",
        "10015151.1",
        "10015258.1",
        "10015259.1",
        "Gender",
        "Age_days",
        "Age",
        "Age_group",
        "Target"]

    for i in a:
        if i not in df_1:
            df_1[i] = -1

    df_1['Gender'] = df['Gender'].replace({'мужской': 1, 'женский': 0})
    df_1['Age_days'] = (np.datetime64('2021-12-31') - df['BirthDate']).dt.days
    df_1['Age'] = ((np.datetime64('2021-12-31') - df['BirthDate']).dt.days / 365.25).astype(int)
    df_1['Age_group'] = df_1.apply(age_group, axis=1)

    patalog = []

    for i in df_1:
        if list(df_1[i]) == [1] and i.isdigit():
            diag = df[df.LaboratoryMethodsKey == int(i)]['LaboratoryMethodsName']
            lst = ''.join(set(diag))
            patalog.append(lst)
    os.remove('lena.csv')

    return df_1.drop('PatientKey', axis=1), patalog